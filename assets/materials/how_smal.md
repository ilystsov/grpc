[Вернуться][main]

---

# Насколько мал "микро"?

**На сколько малы должны быть микросервисы?**

Многие считают, что обсуждение размеров микросервисов может вызвать жаркие споры среди инженеров. Однако важно понимать,
что сам термин "микро" в данном случае может быть вводящим в заблуждение. Вместо этого предложено использовать просто
звание "сервисы" для избежания путаницы. Проблема слишком маленьких микросервисов заключается в том, что это может идти
вразрез с целью модуляризации кода, делая тестирование сложнее и увеличивая требования к развёртыванию в разработке. В
идеале, каждый микросервис должен заниматься своим делом и легко вписываться в общую картину архитектуры.

**Правила по масштабу микросервиса:**

- Размер должен подходить команде: если команда из пяти человек управляет двадцатью микросервисами, это возможный
  признак проблемы.
- Избегайте создания слишком мелких микросервисов без необходимости, но следите за тем, чтобы один микросервис не
  выполнял совершенно разнообразные функции.

**Пример разбиения онлайн-книжного магазина на микросервисы:**

- **Marketplace** - навигация по сайту.
- **Cart** - учет товаров в корзине и процесс оформления покупки.
- **Transactions** - обработка платежей и отправка квитанций.
- **Inventory** - информация о наличии книг.
- **User Account** - управление учетной записью пользователя.
- **Reviews** - управление отзывами и оценками книг.

Эти сервисы могут быть независимы друг от друга и развертываться отдельно.

**Микросервисы vs Монолиты:**

В целом, на начальном этапе разработки, использование монолитной архитектуры может позволить быстрее двигаться вперед
из-за меньшей сложности в обмене кода и развёртывании. Однако, по мере роста сложности и объема проекта, монолиты могут
стать труднее в поддержке и масштабировании по сравнению с микросервисами. Стартапы часто начинают с монолитов и
переходят к микросервисам по мере роста.

### Пример Микросервисов на Python

**Для онлайн-сайта книг "Books For You" определены два микросервиса:**

- **Marketplace** - базовое веб-приложение, показывающее список книг.
- **Recommendations** - микросервис, предоставляющий рекомендации книг.

**Пример API рекомендаций книг использует Protocol Buffers:**

Определяются категории книг, запрос на рекомендацию (с возможностью выбора категории и ограничения по результатам),
структура рекомендуемой книги и ответ с рекомендациями. Ключевая идея в том, чтобы использовать несколько микросервисов
для поддержки различных функций сайта, обеспечивая таким образом его масштабируемость и гибкость.

**Пример описания API в синтаксисе Protocol Buffers:**

```Protocol Buffers
syntax = "proto3";

enum BookCategory {
    MYSTERY = 0;
    SCIENCE_FICTION = 1;
    SELF_HELP = 2;
}

message RecommendationRequest {
    int32 user_id = 1;
    BookCategory category = 2;
    int32 max_results = 3;
}

message BookRecommendation {
    int32 id = 1;
    string title = 2;
}

message RecommendationResponse {
    repeated BookRecommendation recommendations = 1;
}

service Recommendations {
    rpc Recommend (RecommendationRequest) returns (RecommendationResponse);
}
```

### Ключевые Пункты:

- "Микро" в микросервисах может ввести в заблуждение; важно сосредоточиться на логичности и независимости сервиса.
- Избегайте создания слишком маленьких сервисов, сохраняйте баланс.
- Монолитные приложения могут быть более подходящим выбором на ранних этапах разработки.
- Для сложных и масштабируемых систем микросервисная архитектура может быть более предпочтительна.
- При проектировании микросервисов важно тщательно планировать их взаимодействие и API.

Эти принципы и примеры помогут вам лучше понять, как подходить к проектированию и реализации микросервисной архитектуры
в ваших проектах.

---

[Вернуться][main]


[main]: ../../README.md "содержание"

